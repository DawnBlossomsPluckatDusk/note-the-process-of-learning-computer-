# 树莓派基础知识

## 增加B+型树莓派的USB输出电流

默认为600mA，可以配置为1.2A

1. 修改`/boot/config.txt`文件

	添加：

	```
	safe_mode_gpio = 4
	max_usb_current = 1
	```

	

2. 控制树莓派外部引脚，BCM ARM芯片的38引脚控制USB的电流输出，所以通过`gpio`命令可以进行更改

	```
	在终端中输入:
	gpio -g write 38 0   # BCM的引脚38输出低电平时，对应USB端口输出600mA
	gpio -g mode 38 out  # 将BCM的引脚38设置为输出模式
	gpio -g write 38 1   # BCM的引脚38输出为高电平时，对应USB端口输出1.2A
	```

	先设置引脚38为输出，再设置输出的电平，目的是为了避免输出失误

**当发现B+树莓派的电源指示灯闪烁时，说明目前供电不足**

**由于供电电流不足，B型树莓派可能会启动失败，不断重启**



## 常见的芯片封装形式

1. 双列直插封装(DIP)
2. 单列直插封装(SIP)
3. 小外形晶体管封装(SOT)
4. 塑料有引线芯片载体(PLCC)
5. 薄型QFP(LQFP)
6. 金属圆形封装(TO)
7. 双列表面安装封装(SOP)
8. 薄型缩小SOP(TSSOP)
9. 插针网格阵列(PGA)
10. 球栅阵列封装(BGA)

## 关于SDRAM

经历了四代：

1. SDR 
2. DDR
3. DDR2
4. DDR3

重要参数：**容量** 和 **时钟周期**

+ 容量=存储单元\*体\*每个存储单元的位数

SDRAM中的重要概念：**物理Bank** 和 **芯片位宽**

+ 物理Bank：处理器和SDRAM进行数据交换所需的数据总线宽度
+ 芯片位宽：SDRAM芯片数据总线的位宽

## Package on Package(PoP)

一种芯片安装方式---将两个芯片层叠安装起来 



## LED指示灯

| LED名称 | 颜色 | 功能             | 状态说明                             |
| ------- | ---- | ---------------- | ------------------------------------ |
| ACT     | 绿色 | SD卡状态         | 读/写SD卡时点亮                      |
| PWD     | 红色 | 供电状态         | 正常供电时点亮；闪烁时，说明供电不足 |
| FDX     | 绿色 | 通信状态         | 网卡处于全双工时点亮                 |
| LNK     | 绿色 | 网络连接状态     | 有线网卡正常连接时点亮               |
| 100     | 绿色 | 10M/100M网络状态 | 有线网卡连接到100M时点亮             |

## 显示器接口

树莓派采用的是HDMI接口---分为三类(A，C，D)

传统显示器大多数使用的是VGA接口(D-sub)

DVI是数字视频接口的简称，完整的DVI显示系统包括一个作为信号来源的发送器和一个内置在显示器内的接收器

**HDMI到VGA的转换器需要较大的工作电流**

## SD卡接口

该接口兼容SD，MMC，SDIO

+ SD：安全数字卡，基于flash芯片的存储设备，9针数字引脚接口
+ MMC：多媒体卡，7针数字引脚接口
+ SDIO：采用SD卡接口I/O设备，常见：GPS，WiFi，蓝牙设配器

SD卡的分类：

+ 尺寸上：SD卡，MiniSD卡，MicroSD卡
+ 容量上：SD(最大2GB) ，SDHC(2~32GB) ，SDXC(32GB以上)

SD卡的速度：

| SD卡等级 | 速度                            |
| -------- | ------------------------------- |
| class0   | 达不到class1的所有速度          |
| class1   | 最低写入2.0MB/s                 |
| class4   | 最低写入4.0MB/s                 |
| class6   | 最低写入6.0MB/s                 |
| class10  | 最低写入10.0MB/s                |
| UHS-1    | 写入50MB/s以内，读出104MB/s以内 |
| UHS-2    | 写入156MB/s以内，读出32MB/s以内 |

## Linux操作系统简介

**一个完整的Linux操作系统由内核(Kernel)，命令解释层(Shell)，文件系统(File Structure)和实用工具四部分组成**

Linux操作系统的核心是其内核(Kernel)，一个内核可以有多个发行版本，但是，一个发行版只能有一个内核

几种发行版的树莓派版本

+ 基于`Debian`修改的`Raspbian`

	特点：稳定，占用内存小，易用性高，资料较多，支持硬件浮点单元

+ 基于`Fedora`修改的`Pidora`

	特点：图形界面友好，稳定性较差

+ `OpenELEC`和`RaspBMC`操作系统

	用于制作家庭媒体中心

+ `Arch Linux`

	特点：轻量，简洁，没有使用`Debian`和`Red Hat(Fredora)`的包管理器

+ `RISC OS`操作系统

	特点：非Linux架构的操作系统

+ `OpenWRT`操作系统

	特点：高度模块化和自动化



## config.txt文件解析

1. 视频设置参数

	+ `hdmi_safe`: 参数用于设置“安全模式“以尝试使用HDMI最大兼容性来启动输出。

		```
		hdmi_safe = 1
		等价于
		hdmi_force_hotplug = 1
		config_hdmi_boost = 4
		hdmi_group = 2
		hdmi_mode = 4
		disable_overscan = 0
		```

	+ `hdmi_force_hotplug`: 参数用于始终检查HDMI显示器是否被接入，应该默认为1

	+ `HDMI_drive`: 参数用于设置是否使用HDMI接口输出声音，设置为1时，不输出；设置为2时，输出

	+ `config_hdmi_boost`: 参数用于设置HDMI接口输出信号的强度，取值为0~7。如果出现HDMI干扰问题可以设置为4

	+ `disable_overscan`：参数用于设置是否允许显示器进行超出扫描，当设置为1时，禁止超出扫描；设置为0时，允许。

		超出扫描用于设置显示器在显示过程中不显示，有四个参数：`overscan_left`,`overscan_right`,`overscan_top`,`overscan_bottom`

	+ `hdmi_group`和`hdmi_mode`两个参数用于联合设置树莓派输出显示分辨率。

		第一个参数用于设置HDMI的类型，有：0，1，2三个值可选择，分别对应：EDID报告首选组，CEA和DMT。

		常用搭配：

		```
		hdmi_group = 1    hdmi_mode = 4     对应720p  60Hz
		hdmi_group = 1    hdmi_mode = 16    对应1080p 60Hz
		
		hdmi_group = 2    hdmi_mode = 4     对应640X480   60Hz
		hdmi_group = 2    hdmi_mode = 9     对应800X600   60Hz
		hdmi_group = 2    hdmi_mode = 16    对应1024X768  60Hz
		hdmi_group = 2    hdmi_mode = 28    对应1280X800  60Hz
		hdmi_group = 2    hdmi_mode = 47    对应1440X900  60Hz
		hdmi_group = 2    hdmi_mode = 51    对应1600X1200 60Hz
		hdmi_group = 2    hdmi_mode = 81    对应1366X768  60Hz
		hdmi_group = 2    hdmi_mode = 82    对应1920X1080 60Hz
		```

	+ `display_rotate`: 参数用于设置屏幕顺时针旋转的角度，有0, 1($90^o$), 2($180^o$), 3($270^o$), 0x10000(水平翻转), 0x20000(垂直翻转)

	+ `sdty_mode`: 参数用于设置复合信号输出接口(RCA)的视频格式，有：0(NTSC), 1(日本版NTSC), 2(PAL), 3(巴西版PAL)

2. 内存和处理器设置

	+ `arm_freq`: 参数用于设置处理器的工作频率，以MHz为单位，默认700
	+ `core_freq`: 参数用于设置处理器的核心工作频率，以MHz为单位，默认250
	+ `sdram_freq`: 参数用于设置内存的工作频率，以MHz为单位，默认为500
	+ `over_voltage`: 参数用于设置处理器的核心电压调节 取值为：-16~8，0.025V为一个刻度步进，默认0，即核心电压为1.2V
	+ `gpu_men`: 参数用于设置分配给GPU共享的内存大小，单位为MB

## X协议和常见的Linux桌面环境

**X协议**：运行在Linux上的桌面环境软件都应该遵守这个协议

常见的Linux桌面环境：

+ KDE：他是K桌面环境(`Kool Desktop Environment`)的缩写，整个系统采用的都是Qt程序库
+ GNOME：他是GTK+(GIMP Toolkit)编写的一个桌面环境，是GNU计划的一部分，拥有高质量的平滑文本渲染特性
+ Unity：主要被设计成可更高效地使用屏幕空间
+ LXDE：轻量级，快速地桌面环境，注重于实用性和轻巧性，并且尽量降低对系统资源地要求

## 树莓派的文件结构

| 文件夹     | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| boot       | 存放树莓派系统启动时所需要的重要文件，包括cmdline.txt, config.txt |
| etc        | 存放树莓派地配置文件，其中有两个比较重要地文件夹，X11和init.d，前者是桌面环境地配置文件，后者是启动各种服务的脚本 |
| bin        | 存放树莓派系统中安装的和自带的各种应用程序                   |
| lib        | 存放树莓派系统的内核模块和驱动程序                           |
| sys        | 这是树莓派系统上一个可以用于操作硬件的目录                   |
| tmp        | 存放临时文件                                                 |
| mnt        | 用于临时挂载文件系统的目录                                   |
| srv        | server的缩写，用于存放服务启动后需要提取的数据               |
| home       | 树莓派用户的主目录，在其中以各个子文件夹的形式存放不同用户的数据，默认有一个pi的子目录对应用户名为pi |
| opt        | 用于测试大型软件的安装目录，通常默认为空                     |
| dev        | 存放树莓派系统硬件对应的文件                                 |
| root       | 这是用户的主目录，**访问该目录需要root权限**                 |
| media      | 用于挂载可移除的存储设备，例如：U盘                          |
| run        | 存放系统运行时的信息                                         |
| selinux    | 用于安全控制的目录，默认为空                                 |
| lost+found | 当文件系统发生错误的时候，可能产生的文件碎片将被放在这个目录下，**访问需要root权限** |
| var        | 存放系统日志或者脱机缓存文件的目录，在其中有log(日志)，mail(邮件),等子目录 |
| sbin       | 存放用于系统维护和管理的文件                                 |
| usr        | 存放用户的应用程序和数据的目录，其中有lib(库文件)，games(游戏)等 |
| proc       | 用于存放操作系统和各个运行进程中相关信息的虚拟目录           |

## ls命令参数

| 选项   | 说明                                                         |
| ------ | ------------------------------------------------------------ |
| -a     | 列出目录下的所有文件，包括以`.`开头的隐藏文件                |
| -d     | 将目录像文件一样显示，而不是显示其下的文件                   |
| -e     | 输出时间的全部信息，而不是简略信息                           |
| -k     | 以k字节的形式表示文件的大小                                  |
| -l     | 列出文件的详细信息                                           |
| -p或-F | 在每个文件名后附上一个字符说明该文件的类型，`*`表示可执行的普通文件；`/`表示目录；`@`表示符号链接；`|`表示FIFOs；`=`表示套接字 |
| -s     | 在每个文件后输出该文件的大小                                 |
| -t     | 以时间排序                                                   |
| -u     | 以文件上次被访问的时间排序                                   |
| -Q     | 把输出的文件名用双引号括起来                                 |
| -R     | 列出所有子目录下的文件                                       |
| -S     | 以文件大小排序                                               |
| -X     | 以文件的扩展名排序                                           |

## Linux文件类型

| 文件类型 | 说明         |
| -------- | ------------ |
| -        | 常规文件     |
| d        | 目录         |
| b        | 块特殊设备   |
| c        | 字符特殊设备 |
| p        | 有名管道     |
| s        | 信号         |
| m        | 共享存储器   |

## Linux常用命令简谈

1. 显示文件内容：cat 文件列表
2. 复制文件：cp 源文件或目录 目标文件或目录
3. 移动和重命名文件： mv 源文件 目标文件
4. 文件内容统计命令：wc 文件列表  ---> 常用参数：-c(统计字节数)，-l(统计行数)，-w(统计字数)
5. 创建目录：mkdir 目录 --->`-m`参数可以设置权限
6. 删除目录：rmdir 目录列表
7. 显示当前工作目录：pwd
8. 改变当前工作目录：cd
9. 用户切换：su 用户名
10. 提升管理员权限：sudo 其他命令



## 查看Linux进程管理命令

**查看当前进程**：ps

**终止一个指定的进程**：kill 进程号(PID)

在ps中使用`aux`参数显示内容说明

| 标题名  | 说明                                                         |
| ------- | ------------------------------------------------------------ |
| USER    | 该进程的所有用户                                             |
| PID     | 该进程的ID                                                   |
| %CPU    | 该进程的CPU占有率                                            |
| %MEM    | 该进程的物理内存占有率                                       |
| VSZ     | 该进程占用的虚拟内存大小，单位为KB                           |
| RSS     | 该进程占用的物理内存大小，单位为KB                           |
| TTY     | 该进程对应的终端编号                                         |
| STAT    | 该进程的状态：D(不可中断的静止),R(正在执行中),S(静止),T(暂停执行),Z(不存在但是暂时无法清除),W(没有足够的内存分页),<(高优先级),N(低优先级),L(有内存分页且锁定) |
| START   | 该进程启动时间                                               |
| TIME    | 该进程的执行时间                                             |
| COMMAND | 执行该进程的命令                                             |

## IP地址管理命令

使用`ifconfig`**可以查看和配置网络的地址和参数**，包括IP地址，网络掩码，广播地址等----需要使用管理员权限

```
ifconfig [选项][网络接口]   ----用来查看当前系统的网络配置情况
ifconfig 网络接口[选项]地址  ----用来配置指定接口的IP地址，网络掩码，广播地址等
```

常用参数

| 选项              | 说明                     |
| ----------------- | ------------------------ |
| -interface        | 指定的网络接口名         |
| up                | 激活指定的网络接口卡     |
| down              | 关闭指定的网络接口卡     |
| broadcast address | 设置接口的广播地址       |
| point to point    | 启用点对点方式           |
| address           | 设置指定接口设备的IP地址 |
| netmask address   | 设置接口的子网掩码地址   |

## man命令参数

man命令用于**查找其他命令的具体用法**

| 选项 | 说明                                               |
| ---- | -------------------------------------------------- |
| -f   | 只显示命令的功能而不显示其中详细说明的文档         |
| -w   | 不显示手册页，只显示将被格式化和显示的文件所在位置 |
| -a   | 显示所有的手册页，而不是只显示第一个               |
| -E   | 在每行的末尾显示`$`符号                            |

man手册的分页可以分为9个部分，可以用`man 数字 命令`,每个部分说明

+ Executable programs or shell commands：可执行程序或shell命令
+ System calls： Linux内核的系统调用
+ Library calls： 应用程序库函数的调用
+ Special files： 特殊文件，通常是/dev文件下的设备文件
+ File formats and conventions： 文件的结构或协议
+ Games： 游戏
+ Miscellaneous： 杂项，包括宏定义包和一些协议
+ System administration commands： 一些需要使用root权限才能使用的命令
+ Kernel routines： 一些非标准的内核例程

**除了man命令，还可以使用`--help`参数和`info`命令来获取帮助**

## shutdown和reboot命令参数---需要root权限

shutdown用于安全关闭树莓派 ---->`shutdown [选项][时间][警告信息]`

shutdown参数说明

| 选项 | 说明                                       |
| ---- | ------------------------------------------ |
| -k   | 并不是真正关机，只是发送警告信息给所有用户 |
| -r   | 关机后立即重启                             |
| -h   | 关机后不重新启动                           |
| -c   | 取消一个已经运行的shutdown                 |

------

reboot命令用来重新启动计算机 ----->`reboot [选项]`



| 选项 | 说明                                              |
| ---- | ------------------------------------------------- |
| -n   | 在关机前不做将内存资料写回硬盘的动作              |
| -w   | 并不会真正关机，只会把记录写到/var/log/wtmp文件里 |
| -d   | 不把记录写到/var/log/wtmp档案里                   |
| -f   | 强迫关机，不调用shutdown指令                      |
| -i   | 在关机之前先把所有网络相关的装置先停止            |

## 查看内核和发行版本号命令：uname和lsb_release

| 选项 | 说明                 |
| ---- | -------------------- |
| -a   | 显示全部             |
| -s   | 显示内核名称         |
| -n   | 显示网络节点主机名称 |
| -r   | 显示内核发行版本     |
| -v   | 显示内核版本号       |
| -m   | 显示系统硬件主机名称 |
| -p   | 显示处理器名称       |

