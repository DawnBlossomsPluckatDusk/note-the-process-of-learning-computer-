# stm32基础

[TOC]



## stm32命名规则

以`STM32F103ZET6`为例

+ STM32：表示32bit的MCU
+ F：表示基础型，还有A,L,S,T,W,xP几种类型
+ 103：指具体特性，103表示基础型，还有051，303，407，152
+ Z：指引脚数目，Z表示144pin，C(48pin), R(64pin), V(100pin), B(208), N(216)
+ E：指FLASH大小，E表示512K，C(256K), I(2048K)
+ T：指封装, T(QFP)
+ 6：指温度，6和A代表(-40~+85), 7和B代表(-40~+105), 3和C代表(-40~+125), D代表(-40~+150)

## 数据手册和参考手册

数据手册一般用于芯片选型和设计原理图的参考

参考手册主要用于编程时查看

## STM32中四条总线----驱动单元

### `ICode`总线

指令总线，专门用于取出存放在内部flash的指令

### `DCode`总线

数据总线，常量存储在内部的flash中，变量存储在内部的SRAM中。

Dcode总线和DMA总线都可以访问数据，所以，为了避免访问冲突，在取数时需要通过一个总线矩阵来仲裁，决定数据的访问权

### 系统总线

主要是用于访问外设的寄存器，读写寄存器都是通过该总线完成

### `DMA`总线

主要用于传输数据，数据可以存放在任意位置

## 被动单元

### 内部的flash

用于存放编写好的程序。内核通过`ICode`总线取出里面的指令

### 内部的SRAM

程序的变量，堆栈等开销都是基于内部的SRAM。可以通过`DCode`总线访问

### FSMC

全称为：flexible static memory controller

存在于STM32F10xx系列中的外设

通过FSMC，可以扩展内存，但是只能扩展静态内存

### AHB到APB的桥

从AHB总线延伸出来的两条APB1和APB2总线

开发板上的外设都挂载在这两条总线上

## 存储器映射

存储器映射：给存储器分配地址的过程

如果在此基础上，再给存储器分配一个地址就叫做**存储器重映射**

ARM将4GB的地址空间粗略的划分为8块，每块512MB(详细可参照数据手册)

Block0用来设计成内部FLASH，Block1用来设计称内部RAM，Block2用来设计成片上外设

## 寄存器映射

寄存器映射：给已经分配好地址的有特定功能的内存单元取别名的过程

## STM32外设地址映射

片上外设区分为三条总线，根据外设速度的不同，不同总线挂载着不同的外设。

+ APB1 挂载低速外设

+ APB2 和AHB 挂载高速外设

相应总线的最低地址我们称为该**总线的基地址**，总线基地址也是挂载在该总线上的首个外设的地址。

## GPIO的使用