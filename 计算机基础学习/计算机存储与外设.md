# 计算机存储与外设

## Cache存储器和虚拟存储器

### 存储层次

越快的存储器，价格越贵，容量越小。

### Cache概述

计算机的`Cache`存放常用的数据，而不常用的数据则存放在外存中

### Cache存储器结构

`Cache`的存储体与处理器的地址总线和数据总线相连，并与更大的外存并行工作

访问的局部性(`locality of reference`)使得`Cache`存在具有必要性

CPU使用`Cache`控制器(`cache controller`)来确定CPU访问的操作数是否在`Cache`中，如果存在，则成为命中(`hit`)，否则就是失效(`miss`)

### Cache存储器的性能

加速比(`speedup ratio`)是没有Cache是存储系统的访问时间与具有Cache时系统访问时间的比值

当访问次数为N，单次访问主存的时间花费为Tm，访问Cache的时间花费为Tc，Cache的命中率为h，那么加速比为：

S = (N · Tm) /N· (h · Tc + (1-h) · Tm)  

该公式忽略了很多其他的因素，实际的效果并不能完全达到公式所得出的加速比

### Cache的组织和结构

#### 全相联Cache

Cache的`基本存储单元`为包含几个连续字的块(`line`)

内部的数据没有顺序，查找时需要检索Cache中的关键字

相联Cache允许主存储器的任意一块数据存放在任意一块中

相联Cache的大小可以任意，不受限制

相联Cache通过使用相联存储器存放标志位，借此来解决CPU访问的地址问题

可能产生的两种失效：

+ 第一次访问的强制失效
+ 容量失效，在Cache满之后，数据不在Cache中

#### 直接映射Cache





